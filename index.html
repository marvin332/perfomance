<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Яндекс.Дом</title>
    <style>
        html,
        body,
        div,
        span,
        applet,
        object,
        iframe,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        p,
        blockquote,
        pre,
        a,
        abbr,
        acronym,
        address,
        big,
        cite,
        code,
        del,
        dfn,
        em,
        img,
        ins,
        kbd,
        q,
        s,
        samp,
        small,
        strike,
        strong,
        sub,
        sup,
        tt,
        var,
        b,
        u,
        i,
        center,
        dl,
        dt,
        dd,
        ol,
        ul,
        li,
        fieldset,
        form,
        label,
        legend,
        table,
        caption,
        tbody,
        tfoot,
        thead,
        tr,
        th,
        td,
        article,
        aside,
        canvas,
        details,
        embed,
        figure,
        figcaption,
        footer,
        header,
        hgroup,
        menu,
        nav,
        output,
        ruby,
        section,
        summary,
        time,
        mark,
        audio,
        video {
            margin: 0;
            padding: 0;
            border: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
        }


        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        hgroup,
        menu,
        nav,
        section {
            display: block;
        }

        body {
            line-height: 1;
        }

        ol,
        ul {
            list-style: none;
        }

        blockquote,
        q {
            quotes: none;
        }

        blockquote::before,
        blockquote::after,
        q::before,
        q::after {
            content: '';
        }

        table {
            border-collapse: collapse;
            border-spacing: 0;
        }

        /* Base typography & layout */
        html {
            font-size: 100%;
            font-family: Arial, sans-serif;
            line-height: 1.25;
        }

        body {
            display: flex;
            flex-direction: column;
            font-family: inherit;
            line-height: inherit;
            margin: 0;
            height: 100%;
        }

        html,
        body {
            height: 100%;
        }


        .a11y-hidden {
            position: absolute;
            left: auto;
            top: 0;
            width: 1px;
            height: 1px;
            overflow: hidden;
            clip: rect(1px);
        }

        /* Header */
        .header {
            position: relative;
            display: flex;
            flex: 0 0 auto;
            align-items: center;
            height: 5.75rem;
            margin-bottom: 1.875rem;
            padding: 0 2.5rem;
            font-family: Arial, sans-serif;
            border-bottom: 1px solid #f0f0f0;
        }

        @media (max-width: 768px) {
            .header {
                height: 4rem;
                margin-bottom: 0;
                padding: 0 0 0 1.25rem;
                border-bottom: none;
            }
        }

        .header__logo {
            flex: 0 0 auto;
            width: 6.75rem;
            height: 2.3125rem;
            margin-right: 3.25rem;
            background: no-repeat 50%/contain url(assets/logo.svg);
        }

        .header__menu {
            display: none;
            width: 3.5rem;
            height: 100%;
            margin-left: auto;
            background: 50% 50% no-repeat url(assets/icon_list_m@1x.svg);
            border: none;
            appearance: none;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .header__menu {
                display: block;
            }
        }

        .header__links {
            display: flex;
            gap: 1.75rem;
            margin: 0;
            padding: 0;
        }

        @media (max-width: 768px) {
            .header__links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                z-index: 1;
                width: 100%;
                padding: 1.25rem;
                background: #fff;
                box-shadow: 0 2px 6px rgba(197, 186, 186, 0.5);
                flex-direction: column;
            }
            .header__links-opened,
            .header__links-toggled {
                display: flex;
                animation-fill-mode: both;
            }
            .header__links-opened {
                animation: showMenu 0.3s ease-in-out;
            }
            .header__links-toggled {
                animation: hideMenu 0.3s ease-in-out;
            }
        }

        @keyframes showMenu {
            from {
                transform: translateY(-1rem);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes hideMenu {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-1rem);
                opacity: 0;
                visibility: hidden;
            }
        }

        .header__item {
            margin: 0;
            padding: 0;
        }

        .header__link {
            font-weight: 700;
            opacity: 0.6;
            text-decoration: none;
            color: #333;
            transition: opacity 0.15s ease-in-out;
        }

        .header__link:hover,
        .header__link_current {
            opacity: 1;
        }


        .main {
            display: grid;
            grid-template-columns: 50% 50%;
            gap: 1.625rem;
            padding: 0 2.5rem;
        }

        @media (max-width: 768px) {
            .main {
                padding: 0 1.25rem;
            }
        }

        @media (max-width: 1024px) {
            .main {
                grid-template-columns: 100%;
            }
        }

        .main__devices {
            grid-column: 1 / 3;
        }

        @media (max-width: 1024px) {
            .main__devices {
                grid-column-end: 2;
            }
        }

        /* Section titles */
        .section__title-header {
            margin: 0 0 1.25rem 0;
            font-size: 1.125rem;
            font-weight: 700;
            color: #333;
        }

        .section__title {
            display: flex;
            align-items: baseline;
            margin: 0 0 1.25rem 0;
        }

        @media (max-width: 768px) {
            .section__title {
                gap: 1rem;
            }
            .section__main-title {
                display: none;
            }
        }


        .section__select {
            display: none;
            margin-left: auto;
            padding: 0.4375rem 1.9375rem 0.5rem 1rem;
            border: none;
            border-radius: 1.25rem;
            font-size: 0.8125rem;
            font-weight: 700;
            background: #ffd93e url(assets/arrow-down.svg) no-repeat calc(100% - 1rem) 50%;
            appearance: none;
        }

        @media (max-width: 768px) {
            .section__select {
                display: block;
            }
        }


        .section__tabs {
            display: flex;
            gap: 0.625rem;
            padding: 0;
            margin-left: 0.8125rem;
            list-style: none;
        }

        @media (max-width: 768px) {
            .section__tabs {
                display: none;
            }
        }

        .section__tab {
            padding: 0.4375rem 0.9375rem 0.5rem;
            font-size: 0.8125rem;
            font-weight: 700;
            background: #f7f7f7;
            border-radius: 1024px;
            cursor: pointer;
            transition: background-color 0.25s ease-in-out, box-shadow 0.25s ease-in-out;
        }

        .section__tab_active {
            background: #ffd93e;
        }

        .section__tab:not(.section__tab_active):hover {
            background: #fff;
            box-shadow: 0 2px 6px rgba(197, 186, 186, 0.5);
        }


        .hero-dashboard {
            display: flex;
            gap: 0.9375rem;
            height: 20.6875rem;
            background: url(assets/bg2x_1_11zon.webp) no-repeat 50%/1260px;
            border-radius: 1.25rem;
        }

        @media (max-width: 768px) {
            .hero-dashboard {
                flex-direction: column;
                height: auto;
                gap: 1.25rem;
                margin-bottom: 0.3125rem;
                background-image: none;
            }
        }

        .hero-dashboard__primary {
            flex: 1;
            padding: 1.25rem 0 1.25rem 1.25rem;
        }

        @media (max-width: 768px) {
            .hero-dashboard__primary {
                padding: 1.25rem;
            }
        }

        .hero-dashboard__title {
            margin: 0.375rem 0;
            font-size: 1.6875rem;
            font-weight: 700;
            color: #333;
        }

        @media (max-width: 768px) {
            .hero-dashboard__title {
                font-size: 1.125rem;
            }
        }

        .hero-dashboard__subtitle {
            margin: 0.375rem 0 0;
            font-size: 0.875rem;
            color: #333;
        }

        @media (max-width: 768px) {
            .hero-dashboard__subtitle {
                margin: 0.3125rem 0 0;
                font-size: 0.75rem;
            }
        }

        .hero-dashboard__info {
            display: flex;
            gap: 1.125rem;
            margin-top: 1.5625rem;
            list-style: none;
        }

        @media (max-width: 768px) {
            .hero-dashboard__info {
                margin-top: 0.9375rem;
            }
        }

        .hero-dashboard__item-title {
            font-size: 0.875rem;
            color: #858585;
        }

        @media (max-width: 768px) {
            .hero-dashboard__item-title {
                font-size: 0.75rem;
            }
        }

        .hero-dashboard__item-details {
            display: flex;
            align-items: center;
            margin-top: 0.25rem;
            font-size: 2.25rem;
            font-weight: 700;
            color: #333;
        }

        @media (max-width: 768px) {
            .hero-dashboard__item-details {
                margin-top: 0.3125rem;
                font-size: 1.5rem;
            }
        }

        .hero-dashboard__icon {
            width: 1.625rem;
            height: 1.625rem;
            margin-left: 0.3125rem;
            background-repeat: no-repeat;
            background-position: 50%;
            background-size: contain;
        }

        @media (max-width: 768px) {
            .hero-dashboard__icon {
                width: 1.375rem;
                height: 1.375rem;
            }
        }

        .hero-dashboard__icon_rain {
            background-image: url(assets/cloud-drizzle.svg);
        }

        /* Schedule list */
        .hero-dashboard__schedule {
            display: flex;
            flex-direction: column;
            gap: 0.9375rem;
            padding: 1.25rem 1.5625rem 1.25rem 0;
            overflow-x: auto;
            list-style: none;
            scrollbar-width: none;
        }

        .hero-dashboard__schedule::-webkit-scrollbar {
            display: none;
        }

        @media (max-width: 768px) {
            .hero-dashboard__schedule {
                flex-direction: row;
                padding: 0 1.25rem 1.25rem;
            }
        }


        .event-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.9375rem;
            list-style: none;
        }

        @media (max-width: 768px) {
            .event-grid {
                display: flex;
                overflow-x: auto;
                padding-bottom: 0.3125rem;
                scrollbar-width: none;
            }
            .event-grid::-webkit-scrollbar {
                display: none;
            }
        }


        .section__panel {
            padding-bottom: 0.625rem;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .section__panel::-webkit-scrollbar {
            display: none;
        }

        .section__panel_hidden {
            display: none;
        }

        .section__panel-list {
            display: flex;
            gap: 0.9375rem;
            list-style: none;
        }


        .section__panel-wrapper {
            position: relative;
        }

        .section__arrow {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 10px;
            width: 18px;
            background: url(./assets/arrow-left.png) no-repeat 50%;
            transform: rotate(180deg);
            cursor: pointer;
        }

        .section__arrow:hover {
            opacity: 0.7;
        }


        .footer {
            display: flex;
            align-items: center;
            height: 4rem;
            margin-top: auto;
            padding: 0 2.5rem;
        }

        @media (max-width: 768px) {
            .footer {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.9375rem;
                height: auto;
                padding: 1rem 2.5rem;
            }
        }

        .footer__list {
            display: flex;
            gap: 0.9375rem;
            list-style: none;
        }

        @media (max-width: 768px) {
            .footer__list {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        .footer__link {
            font-size: 0.75rem;
            color: #858585;
            text-decoration: none;
            transition: opacity 0.15s ease-in-out;
        }

        .footer__link:hover {
            color: #000;
        }

        .footer__copyright {
            margin-left: auto;
            font-size: 0.75rem;
            color: #858585;
        }

        @media (max-width: 768px) {
            .footer__copyright {
                margin-left: 0;
            }
        }


        .event__button {
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            gap: 0.1875rem;
            width: 100%;
            min-width: 12.5rem;
            height: 7.5rem;
            padding: 0.875rem;
            border: none;
            border-radius: 1.25rem;
            background: #f7f7f7;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.25s ease-in-out, box-shadow 0.25s ease-in-out;
            appearance: none;
        }

        .event_slim .event__button {
            height: 6.25rem;
        }

        .event__button:hover {
            background: #fff;
            box-shadow: 0 2px 6px rgba(197, 186, 186, 0.5);
        }

        .event__icon {
            position: absolute;
            top: 0.875rem;
            left: 0.875rem;
            width: 1.5rem;
            height: 1.5rem;
            background-repeat: no-repeat;
            background-position: 50%;
            background-size: contain;
        }

        .event__icon_temp {
            background-image: url(assets/icon_temperature.svg);
        }

        .event__icon_temp2 {
            background-image: url(assets/icon_temperature_2.svg);
        }

        .event__icon_light {
            background-image: url(assets/icon_sun.svg);
        }

        .event__icon_light2 {
            background-image: url(assets/icon_sun_2.svg);
        }

        .event__icon_schedule {
            background-image: url(assets/icon_scheduled.svg);
        }

        .event__title {
            margin: 0;
            font-size: 0.875rem;
            font-weight: 700;
            color: #333;
        }

        .event__subtitle {
            font-size: 0.75rem;
            color: #858585;
        }

    </style>
</head>
<body>
<div id="app"></div>

<footer class="footer">
    <ul class="footer__list">
        <li class="footer__item">
            <a class="footer__link" href="/">Помощь</a>
        </li>
        <li class="footer__item">
            <a class="footer__link" href="/">Обратная связь</a>
        </li>
        <li class="footer__item">
            <a class="footer__link" href="/">Разработчикам</a>
        </li>
        <li class="footer__item">
            <a class="footer__link" href="/">Условия использования</a>
        </li>
    </ul>
    <div class="footer__copyright">
        © 1997–2023 ООО «Яндекс»
    </div>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        "use strict";

        // Данные устройств по категориям
        const deviceCategories = {
            all: {
                title: "Все",
                items: [
                    { icon: "light2", iconLabel: "Освещение", title: "Xiaomi Yeelight LED Smart Bulb", subtitle: "Включено" },
                    { icon: "light", iconLabel: "Освещение", title: "D-Link Omna 180 Cam", subtitle: "Включится в 17:00" },
                    { icon: "temp", iconLabel: "Температура", title: "Elgato Eve Degree Connected", subtitle: "Выключено до 17:00" },
                    { icon: "light", iconLabel: "Освещение", title: "LIFX Mini Day & Dusk A60 E27", subtitle: "Включится в 17:00" },
                    { icon: "light2", iconLabel: "Освещение", title: "Xiaomi Mi Air Purifier 2S", subtitle: "Включено" },
                    { icon: "light", iconLabel: "Освещение", title: "Philips Zhirui", subtitle: "Включено" }
                ]
            },
            kitchen: {
                title: "Кухня",
                items: [
                    { icon: "light2", iconLabel: "Освещение", title: "Xiaomi Yeelight LED Smart Bulb", subtitle: "Включено" },
                    { icon: "temp", iconLabel: "Температура", title: "Elgato Eve Degree Connected", subtitle: "Выключено до 17:00" }
                ]
            },
            hall: {
                title: "Зал",
                items: [
                    { icon: "light", iconLabel: "Освещение", title: "Philips Zhirui", subtitle: "Выключено" },
                    { icon: "light2", iconLabel: "Освещение", title: "Xiaomi Mi Air Purifier 2S", subtitle: "Выключено" }
                ]
            },
            lights: {
                title: "Лампочки",
                items: [
                    { icon: "light", iconLabel: "Освещение", title: "D-Link Omna 180 Cam", subtitle: "Включится в 17:00" },
                    { icon: "light", iconLabel: "Освещение", title: "LIFX Mini Day & Dusk A60 E27", subtitle: "Включится в 17:00" },
                    { icon: "light2", iconLabel: "Освещение", title: "Xiaomi Mi Air Purifier 2S", subtitle: "Включено" },
                    { icon: "light", iconLabel: "Освещение", title: "Philips Zhirui", subtitle: "Включено" }
                ]
            },
            cameras: {
                title: "Камеры",
                items: [
                    { icon: "light2", iconLabel: "Освещение", title: "Xiaomi Mi Air Purifier 2S", subtitle: "Включено" }
                ]
            }
        };

        // Удваиваем список всех устройств для демонстрации
        for (let repeat = 0; repeat < 6; repeat++) {
            deviceCategories.all.items = [...deviceCategories.all.items, ...deviceCategories.all.items];
        }

        const categoryKeys = Object.keys(deviceCategories);

        /** Создает элемент списка устройства */
        function renderEventItem(eventData) {
            const listItem = document.createElement("li");
            listItem.className = eventData.slim ? "event event_slim" : "event";

            const button = document.createElement("button");
            button.className = "event__button";

            const iconSpan = document.createElement("span");
            iconSpan.className = `event__icon event__icon_${eventData.icon}`;
            iconSpan.setAttribute("role", "img");
            if (eventData.iconLabel) iconSpan.setAttribute("aria-label", eventData.iconLabel);
            button.appendChild(iconSpan);

            const titleHeading = document.createElement("h4");
            titleHeading.className = "event__title";
            titleHeading.textContent = eventData.title;
            button.appendChild(titleHeading);

            if (eventData.subtitle) {
                const subtitleSpan = document.createElement("span");
                subtitleSpan.className = "event__subtitle";
                subtitleSpan.textContent = eventData.subtitle;
                button.appendChild(subtitleSpan);
            }

            listItem.appendChild(button);
            return listItem;
        }

        const appContainer = document.getElementById("app");

        // Рендер шапки
        appContainer.appendChild((() => {
            const header = document.createElement("header");
            header.className = "header";

            const logoLink = document.createElement("a");
            logoLink.href = "/";
            logoLink.className = "header__logo";
            logoLink.setAttribute("aria-label", "Яндекс.Дом");
            header.appendChild(logoLink);

            const menuButton = document.createElement("button");
            menuButton.className = "header__menu";
            menuButton.setAttribute("aria-expanded", "false");

            const menuText = document.createElement("span");
            menuText.className = "header__menu-text a11y-hidden";
            menuText.textContent = "Открыть меню";
            menuButton.appendChild(menuText);

            header.appendChild(menuButton);

            const linksList = document.createElement("ul");
            linksList.className = "header__links";
            [
                { text: "Сводка", href: "/", current: true },
                { text: "Устройства", href: "/devices" },
                { text: "Сценарии", href: "/scripts" }
            ].forEach(linkInfo => {
                const listItem = document.createElement("li");
                listItem.className = "header__item";

                const anchor = document.createElement("a");
                anchor.className = "header__link";
                anchor.href = linkInfo.href;
                anchor.textContent = linkInfo.text;
                if (linkInfo.current) {
                    anchor.classList.add("header__link_current");
                    anchor.setAttribute("aria-current", "page");
                }

                listItem.appendChild(anchor);
                linksList.appendChild(listItem);
            });
            header.appendChild(linksList);

            let isOpen = false;
            let hasToggled = false;
            menuButton.addEventListener("click", () => {
                hasToggled = true;
                isOpen = !isOpen;
                menuButton.setAttribute("aria-expanded", isOpen);
                menuText.textContent = isOpen ? "Закрыть меню" : "Открыть меню";
                linksList.classList.toggle("header__links_opened", isOpen);
                if (hasToggled) linksList.classList.add("header__links-toggled");
            });

            return header;
        })());

        // Рендер основного контента
        appContainer.appendChild((() => {
            const main = document.createElement("main");
            main.className = "main";

            // Секция "Главное"
            const generalSection = document.createElement("section");
            generalSection.className = "section main__general";

            const generalTitle = document.createElement("h2");
            generalTitle.className = "section__title section__title-header section__main-title";
            generalTitle.textContent = "Главное";
            generalSection.appendChild(generalTitle);

            const dashboard = document.createElement("div");
            dashboard.className = "hero-dashboard";

            const primaryDash = document.createElement("div");
            primaryDash.className = "hero-dashboard__primary";

            const greeting = document.createElement("h3");
            greeting.className = "hero-dashboard__title";
            greeting.textContent = "Привет, Геннадий!";
            primaryDash.appendChild(greeting);

            const statusInfo = document.createElement("p");
            statusInfo.className = "hero-dashboard__subtitle";
            statusInfo.textContent = "Двери и окна закрыты, сигнализация включена.";
            primaryDash.appendChild(statusInfo);

            // Инфо блок
            const infoList = document.createElement("ul");
            infoList.className = "hero-dashboard__info";
            [
                { label: "Дома", value: "+23" },
                { label: "За окном", value: "+19", icon: { type: "rain", label: "Дождь" } }
            ].forEach(info => {
                const infoItem = document.createElement("li");
                infoItem.className = "hero-dashboard__item";

                const titleDiv = document.createElement("div");
                titleDiv.className = "hero-dashboard__item-title";
                titleDiv.textContent = info.label;
                infoItem.appendChild(titleDiv);

                const detailsDiv = document.createElement("div");
                detailsDiv.className = "hero-dashboard__item-details";
                detailsDiv.innerHTML = `${info.value}<span class=\"a11y-hidden\">°</span>`;
                if (info.icon) {
                    const weatherIcon = document.createElement("div");
                    weatherIcon.className = `hero-dashboard__icon hero-dashboard__icon_${info.icon.type}`;
                    weatherIcon.setAttribute("role", "img");
                    weatherIcon.setAttribute("aria-label", info.icon.label);
                    detailsDiv.appendChild(weatherIcon);
                }
                infoItem.appendChild(detailsDiv);
                infoList.appendChild(infoItem);
            });
            primaryDash.appendChild(infoList);
            dashboard.appendChild(primaryDash);

            // Расписание в "Главном"
            const scheduleList = document.createElement("ul");
            scheduleList.className = "hero-dashboard__schedule";
            [
                { icon: "temp", iconLabel: "Температура", title: "Philips Cooler", subtitle: "Начнет охлаждать в 16:30" },
                { icon: "light", iconLabel: "Освещение", title: "Xiaomi Yeelight LED Smart Bulb", subtitle: "Включится в 17:00" }
            ].forEach(item => scheduleList.appendChild(renderEventItem(item)));
            dashboard.appendChild(scheduleList);
            generalSection.appendChild(dashboard);
            main.appendChild(generalSection);

            // Секция "Избранные сценарии"
            const scriptsSection = document.createElement("section");
            scriptsSection.className = "section main__scripts";

            const scriptsTitle = document.createElement("h2");
            scriptsTitle.className = "section__title section__title-header";
            scriptsTitle.textContent = "Избранные сценарии";
            scriptsSection.appendChild(scriptsTitle);

            const scriptsGrid = document.createElement("ul");
            scriptsGrid.className = "event-grid";
            [
                { slim: true, icon: "light2", iconLabel: "Освещение", title: "Выключить весь свет в доме и во дворе" },
                { slim: true, icon: "schedule", iconLabel: "Расписание", title: "Я ухожу" },
                { slim: true, icon: "light2", iconLabel: "Освещение", title: "Включить свет в коридоре" },
                { slim: true, icon: "temp2", iconLabel: "Температура", title: "Набрать горячую ванну", subtitle: "Начнётся в 18:00" }
            ].forEach(item => scriptsGrid.appendChild(renderEventItem(item)));
            scriptsSection.appendChild(scriptsGrid);
            main.appendChild(scriptsSection);

            // Секция "Избранные устройства" с табами
            const devicesSection = document.createElement("section");
            devicesSection.className = "section main__devices";

            const devicesHeader = document.createElement("div");
            devicesHeader.className = "section__title";

            const devicesTitle = document.createElement("h2");
            devicesTitle.className = "section__title-header";
            devicesTitle.textContent = "Избранные устройства";
            devicesHeader.appendChild(devicesTitle);

            const categorySelect = document.createElement("select");
            categorySelect.className = "section__select";
            categoryKeys.forEach(key => {
                const option = document.createElement("option");
                option.value = key;
                option.textContent = deviceCategories[key].title;
                categorySelect.appendChild(option);
            });
            categorySelect.value = "all";
            devicesHeader.appendChild(categorySelect);
            devicesSection.appendChild(devicesHeader);

            const tabList = document.createElement("ul");
            tabList.className = "section__tabs";
            tabList.setAttribute("role", "tablist");
            categoryKeys.forEach((key, index) => {
                const tabItem = document.createElement("li");
                tabItem.className = "section__tab";
                if (index === 0) tabItem.classList.add("section__tab_active");
                tabItem.setAttribute("role", "tab");
                tabItem.setAttribute("aria-selected", index === 0);
                tabItem.setAttribute("tabindex", index === 0 ? "0" : "-1");
                tabItem.id = `tab_${key}`;
                tabItem.setAttribute("aria-controls", `panel_${key}`);
                tabItem.textContent = deviceCategories[key].title;
                tabItem.dataset.tabKey = key;
                tabList.appendChild(tabItem);
            });
            devicesHeader.appendChild(tabList);

            const panelWrapper = document.createElement("div");
            panelWrapper.className = "section__panel-wrapper";

            categoryKeys.forEach((key, index) => {
                const panel = document.createElement("div");
                panel.className = index === 0 ? "section__panel" : "section__panel section__panel_hidden";
                panel.setAttribute("role", "tabpanel");
                panel.setAttribute("aria-hidden", index !== 0);
                panel.id = `panel_${key}`;
                panel.setAttribute("aria-labelledby", `tab_${key}`);

                const listWrapper = document.createElement("ul");
                listWrapper.className = "section__panel-list";
                deviceCategories[key].items.forEach(item => listWrapper.appendChild(renderEventItem(item)));
                panel.appendChild(listWrapper);
                panelWrapper.appendChild(panel);
            });

            const scrollArrow = document.createElement("div");
            scrollArrow.className = "section__arrow";
            scrollArrow.style.display = "none";
            panelWrapper.appendChild(scrollArrow);

            devicesSection.appendChild(panelWrapper);
            main.appendChild(devicesSection);

            // Логика переключения табов и прокрутки
            let activeTab = "all";
            const tabButtons = tabList.querySelectorAll(".section__tab");

            function updateScrollArrow() {
                const currentPanel = panelWrapper.querySelector(".section__panel:not(.section__panel_hidden)");
                if (!currentPanel) return;
                const itemList = currentPanel.querySelector(".section__panel-list");
                let totalWidth = 0;
                Array.from(itemList.children).forEach(child => totalWidth += child.offsetWidth);
                scrollArrow.style.display = totalWidth > currentPanel.offsetWidth ? "block" : "none";
            }

            function switchTab(newKey) {
                if (activeTab === newKey) return;
                const prevTab = tabList.querySelector(`.section__tab[data-tab-key=\"${activeTab}\"]`);
                prevTab.classList.remove("section__tab_active");
                prevTab.setAttribute("aria-selected", "false");
                prevTab.setAttribute("tabindex", "-1");

                activeTab = newKey;

                const nextTab = tabList.querySelector(`.section__tab[data-tab-key=\"${newKey}\"]`);
                nextTab.classList.add("section__tab_active");
                nextTab.setAttribute("aria-selected", "true");
                nextTab.setAttribute("tabindex", "0");

                categorySelect.value = newKey;

                panelWrapper.querySelectorAll(".section__panel").forEach(panelElem => {
                    const isVisible = panelElem.id === `panel_${newKey}`;
                    panelElem.classList.toggle("section__panel_hidden", !isVisible);
                    panelElem.setAttribute("aria-hidden", !isVisible);
                });

                setTimeout(updateScrollArrow, 0);
            }

            categorySelect.addEventListener("input", e => switchTab(e.target.value));
            tabButtons.forEach(button => button.addEventListener("click", () => switchTab(button.dataset.tabKey)));
            scrollArrow.addEventListener("click", () => {
                const currentPanel = panelWrapper.querySelector(".section__panel:not(.section__panel_hidden)");
                if (currentPanel) currentPanel.scrollBy({ left: 400, behavior: "smooth" });
            });

            // Инициализация и обработка resize
            setTimeout(() => {
                updateScrollArrow();
                window.addEventListener("resize", updateScrollArrow);
                const urlParams = new URLSearchParams(window.location.search);
                const initialTab = urlParams.get("tab");
                if (initialTab && categoryKeys.includes(initialTab)) switchTab(initialTab);
            }, 100);

            return main;
        })());
    });



</script>
</body>
</html>
